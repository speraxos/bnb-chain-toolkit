---
title: Marketplace API
description: AI Service Marketplace API documentation - service registration, discovery, subscriptions, reputation
category: api-reference
keywords: [marketplace, api, service, subscription, reputation]
published: true
---

# Marketplace API

Service discovery, subscriptions, analytics, and reputation for AI service marketplace.

## Installation

```bash
npm install @nirholas/universal-crypto-mcp-marketplace
```

## Overview

The Marketplace package provides a complete ecosystem for:
- **Service Registration** - List your AI service
- **Discovery** - Find services by category, price, rating
- **Subscriptions** - Manage recurring payments
- **Analytics** - Track usage and revenue
- **Reputation** - On-chain reviews and ratings

## Main Exports

### MarketplaceClient

Main client for interacting with the marketplace.

```typescript
import { MarketplaceClient } from '@nirholas/marketplace'

const client = new MarketplaceClient({
  network: 'arbitrum',
  rpcUrl: process.env.RPC_URL
})
```

**Methods**:
- `registerService(params)` - Register a new service
- `updateService(id, updates)` - Update service details
- `getService(id)` - Get service by ID
- `searchServices(query)` - Search for services
- `subscribeToService(id, plan)` - Subscribe to a service
- `cancelSubscription(id)` - Cancel subscription

### ServiceRegistry

Contract interaction for service registration.

```typescript
import { ServiceRegistry } from '@nirholas/marketplace/service'

const registry = new ServiceRegistry({ contractAddress, chain })

await registry.register({
  name: 'My AI Service',
  category: 'data-analysis',
  pricing: { type: 'pay-per-use', price: '0.01' }
})
```

### SubscriptionManager

Handle recurring subscription payments.

```typescript
import { SubscriptionManager } from '@nirholas/marketplace/subscriptions'

const manager = new SubscriptionManager()

await manager.createSubscription({
  serviceId: 'service-123',
  plan: 'pro',
  interval: 'monthly',
  price: '10.00'
})
```

### ReputationSystem

On-chain reputation and reviews.

```typescript
import { ReputationSystem } from '@nirholas/marketplace/reputation'

const reputation = new ReputationSystem()

await reputation.submitReview({
  serviceId: 'service-123',
  rating: 5,
  comment: 'Excellent service!',
  verifiedPurchase: true
})
```

### AnalyticsTracker

Track service usage and revenue.

```typescript
import { AnalyticsTracker } from '@nirholas/marketplace/analytics'

const analytics = new AnalyticsTracker()

const stats = await analytics.getServiceStats('service-123')
// { requests: 1000, revenue: '50.00', avgRating: 4.8 }
```

### DiscoveryEngine

AI-powered service discovery.

```typescript
import { DiscoveryEngine } from '@nirholas/marketplace/discovery'

const discovery = new DiscoveryEngine()

const services = await discovery.search({
  category: 'market-data',
  maxPrice: '1.00',
  minRating: 4.0,
  sortBy: 'popularity'
})
```

## Types

### ServiceMetadata

```typescript
interface ServiceMetadata {
  id: string
  name: string
  description: string
  category: ServiceCategory
  pricing: PricingModel
  endpoint: string
  provider: string
  rating: number
  totalRequests: bigint
  createdAt: number
}
```

### PricingModel

```typescript
type PricingModel = 
  | { type: 'pay-per-use'; price: string; currency: 'USDC' | 'USDT' }
  | { type: 'subscription'; plans: SubscriptionPlan[] }
  | { type: 'free'; limits?: UsageLimits }
```

### ServiceCategory

```typescript
type ServiceCategory = 
  | 'defi'
  | 'market-data'
  | 'trading'
  | 'nft'
  | 'analytics'
  | 'ai-inference'
  | 'data-processing'
  | 'other'
```

## Complete Examples

### Register a Service

```typescript
import { MarketplaceClient } from '@nirholas/marketplace'

async function registerMyService() {
  const client = new MarketplaceClient({
    network: 'arbitrum',
    privateKey: process.env.PRIVATE_KEY
  })
  
  const service = await client.registerService({
    name: 'Premium Weather API',
    description: 'Accurate weather forecasts with AI predictions',
    category: 'data-processing',
    pricing: {
      type: 'pay-per-use',
      price: '0.01',
      currency: 'USDC'
    },
    endpoint: 'https://api.myweather.com',
    metadata: {
      version: '1.0.0',
      supportEmail: 'support@myweather.com',
      documentation: 'https://docs.myweather.com'
    }
  })
  
  console.log(`Service registered: ${service.id}`)
  console.log(`Listing URL: https://marketplace.x402.io/service/${service.id}`)
}
```

### Discover and Subscribe

```typescript
import { MarketplaceClient } from '@nirholas/marketplace'

async function findAndSubscribe() {
  const client = new MarketplaceClient({ network: 'arbitrum' })
  
  // Find services
  const services = await client.searchServices({
    category: 'market-data',
    maxPrice: '5.00',
    minRating: 4.5
  })
  
  console.log(`Found ${services.length} services`)
  
  // Subscribe to the top-rated one
  if (services.length > 0) {
    const topService = services[0]
    
    const subscription = await client.subscribeToService(
      topService.id,
      'pro' // Plan name
    )
    
    console.log(`Subscribed to ${topService.name}`)
    console.log(`Monthly cost: ${subscription.price} USDC`)
  }
}
```

### Track Analytics

```typescript
import { AnalyticsTracker } from '@nirholas/marketplace/analytics'

async function viewAnalytics(serviceId: string) {
  const analytics = new AnalyticsTracker()
  
  // Get overall stats
  const stats = await analytics.getServiceStats(serviceId)
  console.log(`Total requests: ${stats.totalRequests}`)
  console.log(`Total revenue: $${stats.totalRevenue}`)
  console.log(`Average rating: ${stats.averageRating}/5`)
  
  // Get time-series data
  const timeSeries = await analytics.getTimeSeriesData(serviceId, {
    metric: 'requests',
    interval: 'day',
    startDate: new Date('2024-01-01'),
    endDate: new Date()
  })
  
  console.log('Daily requests:', timeSeries)
}
```

## Smart Contract Integration

The marketplace uses on-chain smart contracts for:
- Service registry (immutable service listings)
- Subscription management (recurring payments)
- Reputation system (verified reviews)
- Revenue distribution (automatic payments)

**Contract addresses** (Arbitrum):
- ServiceRegistry: `0x...` (see [contracts documentation](/docs/packages/marketplace/contracts))
- SubscriptionManager: `0x...`
- ReputationVault: `0x...`

## See Also

- [Marketplace Guide](/docs/packages/marketplace)
- [Service Registration Tutorial](/docs/tutorials/marketplace-service)
- [Smart Contracts Documentation](/docs/packages/marketplace/contracts)
- [x402 Integration](/docs/x402/integrations/marketplace)
