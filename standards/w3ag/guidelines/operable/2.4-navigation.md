# 2.4 Navigation

DeFi dashboards and portfolio views must be navigable.

## Success Criteria

### 2.4.1 Skip Links (Level A)

**Requirement**: Skip links must be provided to bypass repetitive content like token lists, transaction histories, and navigation menus.

**Intent**: Screen reader users shouldn't have to navigate through 50 tokens to reach the main action area.

**Benefits**:
- **Blind users**: Quick access to main content
- **Keyboard users**: Fewer keystrokes to navigate
- **Motor impairments**: Less repetitive strain

**Techniques**:
```tsx
<DeFiDashboard>
  {/* Skip links - visible on focus */}
  <nav className="skip-links" aria-label="Skip navigation">
    <a href="#portfolio-summary">Skip to portfolio summary</a>
    <a href="#quick-actions">Skip to quick actions</a>
    <a href="#token-list">Skip to token list</a>
  </nav>
  
  <header>
    <Navigation />
    <WalletStatus />
  </header>
  
  <main>
    <section id="portfolio-summary" tabIndex={-1}>
      <h2>Portfolio Summary</h2>
      {/* Summary content */}
    </section>
    
    <section id="quick-actions" tabIndex={-1}>
      <h2>Quick Actions</h2>
      <button>Send</button>
      <button>Swap</button>
      <button>Bridge</button>
    </section>
    
    <section id="token-list" tabIndex={-1}>
      <h2>Your Tokens</h2>
      {/* Long list of tokens */}
    </section>
  </main>
</DeFiDashboard>

// CSS
.skip-links a {
  position: absolute;
  left: -10000px;
  top: auto;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

.skip-links a:focus {
  position: static;
  width: auto;
  height: auto;
}
```

**Failures**:
- No skip links provided
- Skip links don't actually skip content
- Target sections not focusable

---

### 2.4.2 Logical Focus Order (Level A)

**Requirement**: Focus order must follow a logical sequence that matches the visual layout and transaction flow.

**Intent**: Tab navigation should be predictable and match how users visually scan the page.

**Benefits**:
- **Blind users**: Predictable navigation
- **Keyboard users**: Intuitive flow
- **All users**: Consistent mental model

**Techniques**:
```tsx
// Swap interface - logical flow
<SwapInterface>
  {/* 1. Select input token */}
  <TokenSelector id="input-token" tabIndex={0}>
    Select token to swap
  </TokenSelector>
  
  {/* 2. Enter amount */}
  <input 
    type="number" 
    id="input-amount"
    aria-label="Amount to swap"
  />
  
  {/* 3. Swap direction toggle */}
  <button 
    aria-label="Swap input and output tokens"
  >
    ⇅
  </button>
  
  {/* 4. Select output token */}
  <TokenSelector id="output-token">
    Select token to receive
  </TokenSelector>
  
  {/* 5. Review output amount */}
  <output aria-label="You will receive">
    {outputAmount} {outputToken}
  </output>
  
  {/* 6. Settings (secondary) */}
  <button aria-label="Swap settings">⚙️</button>
  
  {/* 7. Action button (primary) */}
  <button className="primary">
    Swap
  </button>
</SwapInterface>

// Avoid tabindex > 0
// ❌ tabIndex={5}
// ✅ Reorder DOM to match visual order
```

**Failures**:
- Tab order doesn't match visual order
- Using positive tabindex values
- Focus jumps unexpectedly

---

### 2.4.3 Section Heading Structure (Level AA)

**Requirement**: Portfolio sections, token lists, and DeFi positions must have proper heading hierarchy that can be navigated by screen reader heading commands.

**Intent**: Screen reader users navigate by headings. Proper structure enables quick section finding.

**Benefits**:
- **Blind users**: Navigate via heading list
- **Cognitive disabilities**: Clear content structure
- **All users**: Better content organization

**Techniques**:
```tsx
<Portfolio>
  <h1>Your Portfolio</h1>
  
  <section aria-labelledby="summary-heading">
    <h2 id="summary-heading">Portfolio Summary</h2>
    <dl>
      <dt>Total Value</dt>
      <dd>$12,345.67</dd>
      <dt>24h Change</dt>
      <dd>+$234.56 (+1.9%)</dd>
    </dl>
  </section>
  
  <section aria-labelledby="assets-heading">
    <h2 id="assets-heading">Your Assets</h2>
    
    <div aria-labelledby="tokens-heading">
      <h3 id="tokens-heading">Tokens (5)</h3>
      <TokenList tokens={tokens} />
    </div>
    
    <div aria-labelledby="nfts-heading">
      <h3 id="nfts-heading">NFTs (3)</h3>
      <NFTGrid nfts={nfts} />
    </div>
  </section>
  
  <section aria-labelledby="defi-heading">
    <h2 id="defi-heading">DeFi Positions</h2>
    
    <div aria-labelledby="staking-heading">
      <h3 id="staking-heading">Staking</h3>
      <StakingPositions />
    </div>
    
    <div aria-labelledby="lending-heading">
      <h3 id="lending-heading">Lending & Borrowing</h3>
      <LendingPositions />
    </div>
    
    <div aria-labelledby="lp-heading">
      <h3 id="lp-heading">Liquidity Pools</h3>
      <LPPositions />
    </div>
  </section>
</Portfolio>
```

**Failures**:
- No headings in portfolio sections
- Skipped heading levels (h1 → h3)
- Headings used for styling only

---

### 2.4.4 Non-Conflicting Shortcuts (Level AAA)

**Requirement**: Custom keyboard shortcuts must not conflict with assistive technology commands and can be customized or disabled.

**Intent**: AT users rely on specific key combinations. Conflicts break their tools.

**Benefits**:
- **Screen reader users**: AT shortcuts work normally
- **Power users**: Customizable shortcuts

**Techniques**:
```tsx
// Default shortcuts that avoid common AT conflicts
const defaultShortcuts = {
  'Ctrl+K': 'searchTokens',    // Opens token search
  'Ctrl+Shift+S': 'swap',       // Open swap
  'Ctrl+Shift+P': 'portfolio',  // Open portfolio
  // Avoid: arrow keys alone, Tab, common screen reader keys
};

// Allow customization
<ShortcutSettings>
  <p>Customize keyboard shortcuts</p>
  
  <label>
    Open token search:
    <ShortcutInput 
      value={shortcuts.searchTokens}
      onChange={(key) => updateShortcut('searchTokens', key)}
    />
  </label>
  
  <label>
    <input 
      type="checkbox"
      checked={shortcutsEnabled}
      onChange={toggleShortcuts}
    />
    Enable keyboard shortcuts
  </label>
</ShortcutSettings>

// Respect prefers-reduced-motion for any animated shortcuts
```

**Failures**:
- Shortcuts override screen reader commands
- Cannot disable shortcuts
- Single-key shortcuts without modifier

---

## Testing Checklist

- [ ] Skip links present and functional
- [ ] Skip link targets have tabindex="-1"
- [ ] Tab order matches visual layout
- [ ] No positive tabindex values used
- [ ] Proper heading hierarchy (h1→h2→h3)
- [ ] All sections have headings
- [ ] Custom shortcuts don't conflict with AT
- [ ] Shortcuts can be disabled

## Related Components

- [SkipLinks.tsx](../../components/SkipLinks.tsx)
- [Portfolio.tsx](../../components/Portfolio.tsx)
- [ShortcutManager.tsx](../../components/ShortcutManager.tsx)
